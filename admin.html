<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin – Artikeldaten pflegen</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Open Sans', Arial, sans-serif; }
    h1, h2, h3 { font-family: 'Montserrat', Arial, sans-serif; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center justify-start p-4">
  <div class="w-full max-w-2xl mt-8">
    <h1 class="text-2xl font-bold mb-6 text-center" style="color:#f6ae42">Admin: Artikeldaten pflegen</h1>
    <form id="artikelForm" class="bg-white shadow-md rounded-lg p-6 mb-4">
      <div class="mb-4">
        <label class="block font-semibold mb-1">Artikelname</label>
        <input type="text" id="artikelname" class="w-full border rounded px-3 py-2" required>
      </div>
      <div class="mb-4">
        <label class="block font-semibold mb-1">Artikelnummer</label>
        <input type="text" id="artikelnummer" class="w-full border rounded px-3 py-2" required>
      </div>
      <div class="mb-4">
        <label class="block font-semibold mb-1">EAN</label>
        <input type="text" id="ean" class="w-full border rounded px-3 py-2" required>
      </div>
      <div class="mb-4">
        <label class="block font-semibold mb-1">UD-ID</label>
        <input type="text" id="udid" class="w-full border rounded px-3 py-2" required>
      </div>
      <div class="mb-4">
        <label class="block font-semibold mb-1">Beschreibung</label>
        <textarea id="beschreibung" class="w-full border rounded px-3 py-2" rows="2" required></textarea>
      </div>
      <div class="mb-4">
        <label class="block font-semibold mb-1">Artikelbild-Link (URL)</label>
        <input type="text" id="bild" class="w-full border rounded px-3 py-2" placeholder="https://...">
      </div>
      <div class="mb-4">
        <label class="block font-semibold mb-2">PDF-Links für Sprachen</label>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
          <input type="text" id="pdf_de" class="border rounded px-2 py-1" placeholder="Deutsch PDF-Link (de)">
          <input type="text" id="pdf_nl" class="border rounded px-2 py-1" placeholder="Nederlands PDF-Link (nl)">
          <input type="text" id="pdf_pl" class="border rounded px-2 py-1" placeholder="Polski PDF-Link (pl)">
          <input type="text" id="pdf_ro" class="border rounded px-2 py-1" placeholder="Română PDF-Link (ro)">
          <input type="text" id="pdf_ru" class="border rounded px-2 py-1" placeholder="Русский PDF-Link (ru)">
          <input type="text" id="pdf_sv" class="border rounded px-2 py-1" placeholder="Svenska PDF-Link (sv)">
          <input type="text" id="pdf_sl" class="border rounded px-2 py-1" placeholder="Slovenščina PDF-Link (sl)">
          <input type="text" id="pdf_tr" class="border rounded px-2 py-1" placeholder="Türkçe PDF-Link (tr)">
          <input type="text" id="pdf_fi" class="border rounded px-2 py-1" placeholder="Suomi PDF-Link (fi)">
          <input type="text" id="pdf_fr" class="border rounded px-2 py-1" placeholder="Français PDF-Link (fr)">
          <input type="text" id="pdf_en" class="border rounded px-2 py-1" placeholder="English PDF-Link (en)">
          <input type="text" id="pdf_it" class="border rounded px-2 py-1" placeholder="Italiano PDF-Link (it)">
          <input type="text" id="pdf_es" class="border rounded px-2 py-1" placeholder="Español PDF-Link (es)">
          <input type="text" id="pdf_da" class="border rounded px-2 py-1" placeholder="Dansk PDF-Link (da)">
          <input type="text" id="pdf_cs" class="border rounded px-2 py-1" placeholder="Čeština PDF-Link (cs)">
          <input type="text" id="pdf_hu" class="border rounded px-2 py-1" placeholder="Magyar PDF-Link (hu)">
          <input type="text" id="pdf_hr" class="border rounded px-2 py-1" placeholder="Hrvatski PDF-Link (hr)">
        </div>
      </div>
      <button type="submit" class="mt-4 w-full bg-yellow-400 hover:bg-yellow-500 text-white font-bold py-2 px-4 rounded transition">JSON generieren</button>
    </form>
    <div id="jsonOutput" class="bg-gray-100 border border-gray-300 rounded p-4 font-mono text-sm whitespace-pre-wrap"></div>
  </div>
  <script>
    const form = document.getElementById('artikelForm');
    const output = document.getElementById('jsonOutput');
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      const artikelnummer = document.getElementById('artikelnummer').value.trim();
      const artikelname = document.getElementById('artikelname').value.trim();
      const ean = document.getElementById('ean').value.trim();
      const udid = document.getElementById('udid').value.trim();
      const beschreibung = document.getElementById('beschreibung').value.trim();
      const bild = document.getElementById('bild').value.trim();
      const sprachen = ['de','nl','pl','ro','ru','sv','sl','tr','fi','fr','en','it','es','da','cs','hu','hr'];
      let pdfs = {};
      sprachen.forEach(sprache => {
        const val = document.getElementById('pdf_' + sprache).value.trim();
        if(val) pdfs[sprache] = val;
      });
      let artikel = {
        artikelnummer,
        artikelname,
        ean,
        udid,
        beschreibung,
        pdfs
      };
      if(bild) artikel.bild = bild;
      output.textContent = JSON.stringify(artikel, null, 2);
      // --- NEU: Sende an Netlify Function ---
      try {
        const res = await fetch('/.netlify/functions/add-article', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(artikel)
        });
        const result = await res.json();
        if(result.success) {
          alert('Artikel erfolgreich gespeichert!');
        } else {
          alert('Fehler beim Speichern: ' + (result.error || 'Unbekannter Fehler'));
        }
      } catch (err) {
        alert('Fehler beim Speichern: ' + err.message);
      }
    });
  </script>
</body>
</html> 